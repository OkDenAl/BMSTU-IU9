# Лабораторная работа №5: GLR-парсер

## Реализация

Реализован GLR-парсер за авторством японского ученого Масару Томита. 

### Стек
Выводится в папку stack текущей директории.

Все возможные свертки происходят в первую очередь (свертка по всем путям из одной вершины происходит за один шаг), перенос происходит уже после этого для всех вершин одновременно, поэтому считается одним шагом. Рядом с вершинами стека указываются действия, которые должны произойти с ними на следующем шаге, для каждого шага подписана текущая позиция считывания и токен, расположенный в ней. Текущие вершины стека имеют округлую форму. В скобках в каждом узле указана вершина леса разбора, на которую он ссылается. 

### Лес разбора
Выводится в папку tree текущей директории.

Запакованный лес разбора. При большом количестве узлов в визуализации может теряться порядок вершин, дочерних для данной; на уровне программы они упорядочены как должны. Упакованные вершины визуализируются как кластеры, где каждый путь разбора представлен узлом графа.

## Выходные данные

В папках stack и tree создаются только описания на языке dot, для преобразования их в картинки можно воспользоваться, например, командой для Windows:
```
mkdir stack/images | forfiles /P stack /m "*.dot" /c "cmd /c dot -Tpng @file -o images/@fname.png"
```

## Входные данные

Программа подразумевает ввод некоторой входной грамматики без эпсилон-правил.

Особенности записи грамматики:
1) Разделение всех правил грамматики через пробел
2) Символ `@` зарезервирован в качестве служебного и не может фигурировать в грамматике
3) Разрешено использовать символ `|` ("или") в обычном его понимании

Примеры грамматик можно найти в папке `./grammars`

### Запуск

0) Запустить проект в Docker
```
make run-docker-compose
```
```
make dev
```


Дальнейшие команды запускать в появившемся терминале
 
1) Сбилдить проект:
```
$ make generate
```
*При повторном запуске использовать*
```
$ make build-project
```
2) Запустить программу в обычном режиме (2 способа)
    1) ```
       $ ./build/lab5
       ```
    2) ```
        $ make run 
       ```
**ВАЖНО** При запуске программы поддерживаются следующие параметры:

1) `-g` `--grammar` - путь к файлу с грамматикой
2) `-i` `--input` - предложение на вход парсера, токены отделяются пробелами
3) `-f` `--file` - путь к файлу с предложением на вход парсера
4) `-s` `--step` - шаг разбора, для которого будет выведен снимок
5) `-a` `--all` - указание выводить снимки на каждом шаге
6) `-l` `--last` - указание выводить снимки только на последнем шаге

* Если запускать через `make run` то необходимо прописать эти флаги в `Makefile`

### Примеры:
- ./build/lab5 -g grammars/arith_grammar.txt -i "id * id + id" -a
- ./build/lab5 -g grammars/simple_grammar.txt -i "b b b b b b b" -a
- ./build/lab5 -g grammars/ext_nformal_grammar.txt -i "n v n and n v det n p det n" -a
